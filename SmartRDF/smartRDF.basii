/* after use clear all vars
pja 01-02-2020 editing actCase
pja 12-29-2019 editing act1
pja 12-28-2019 changed wword to fpword
               dup before ==token 
pja 12-27-2019 added comments
pja 12-1-2019 orig

basii protocol output-filename [ def paragraph :- [ [[ clause-number ]] [ verbs till period ] ] till ; ] till @endend
*/
smartRDFX.py

def RDFMain :-
[[ 1 ]]  "script file" ask dup "scriptF" ! initIOI  RDFMain2 . 
;

def RDFMain2 :-
[[ 1 ]] fpword ... .
[[ 2 ]] ==RDF getSubject 
        fpword "predicate" ! getObject act1 tail. .
[[ 3 ]] "error at main " abort .
;

def getSubject :-
[[ 1 ]] fpword ... .
[[ 2 ]] dup ==( complexSubject fpword ==)  .
[[ 3 ]] "subject" !  .
;

def complexSubject :-
[[ 1 ]] fpword "subject1" ! ... .
[[ 2 ]] fpword "predicate1" ! ... .
[[ 3 ]] fpword "object1" !  .
;

def getObject :-
[[ 1 ]] fpword ... .
[[ 2 ]] dup ==( complexObject fpword ==)  .
[[ 3 ]] "Object" !  .
;

def complexObject :-
[[ 1 ]] fpword "subject2" ! ... .
[[ 2 ]] fpword "predicate2" ! ... .
[[ 3 ]] fpword "object2" !  .
;

def initIOI :- 
/* sets up fioiClass vectors 
g: filename on datastack 
*/ 
[[ 1 ]] "fioiP" takeV ... . /* file parser */
[[ 2 ]] "RDF.db" "SQV" takeV ... . /* database */
[[ 3 ]] "create table if not exists RDFTuple ( ix int primary key, subject , predicate, object, ssubject, spredicate, sobject, osubject, opredicate, oobject);" SQX .
;
def act1 :- 
[[ 1 ]] 
/* save a complete tuple */
/* cv format */
"0"
"subject" @ "subject" 
"predicate" @ "predicate" 
"object" @ "object" 
"ssubject" @ "ssubject" 
"spredicate" @ "spredicate" 
"sobject" @ "sobject" 
"osubject" @ "osubject" 
"opredicate" @ "opredicate" 
"oobject" @ "oobject" 
"RDFTuple" /* table name */
SQWrite
/* clear */
"" "subject" !
"" "predicate" !
"" "object" !
"" "ssubject" !
"" "spredicate" !
"" "sobject" !
"" "osubject" !
"" "opredicate" !
"" "oobject" !
.
;
  
@endend @endend

